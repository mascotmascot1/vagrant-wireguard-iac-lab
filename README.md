<div align="center">

<img src="https://github.com/mascotmascot1/media/blob/main/in-use/vagrant-wireguard-iac-lab-gray.svg" 
     alt="Vagrant WireGuard IaC Lab" 
     width="640" 
     height="80" 
     style="vertical-align: middle;" />

[![Vagrant](https://img.shields.io/badge/Vagrant-1563FF?style=for-the-badge&logo=vagrant&logoColor=white)](https://www.vagrantup.com/)
[![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)](https://www.docker.com/)
[![VirtualBox](https://img.shields.io/badge/VirtualBox-21416b?style=for-the-badge&logo=virtualbox&logoColor=white)](https://www.virtualbox.org/)
[![SSH](https://img.shields.io/badge/SSH-232F3E?style=for-the-badge&logo=ssh&logoColor=white)](https://www.ssh.com/academy/ssh/protocol)
[![Bash](https://img.shields.io/badge/Bash-4EAA25?style=for-the-badge&logo=gnu-bash&logoColor=white)](https://www.gnu.org/software/bash/)
[![Ubuntu](https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=ubuntu&logoColor=white)](https://releases.ubuntu.com/jammy/)
[![WireGuard](https://img.shields.io/badge/WireGuard-88171A?style=for-the-badge&logo=wireguard&logoColor=white)](https://www.wireguard.com/)

**Infrastructure as Code (IaC) project demonstrating automated deployment of a secure,<br>
three-node network cluster with WireGuard VPN and Zero-Touch SSH configuration.**

<p align="center">
  <kbd><a href="#-architecture-of-virtual-machines--%EF%B8%8F-key-features-of-automation">Architecture</a></kbd> ‚Ä¢
  <kbd><a href="#-1-zero-touch-ssh-provisioning-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–æ—Å—Ç—É–ø–∞">SSH Automation</a></kbd> ‚Ä¢
  <kbd><a href="#-3-wireguard-vpn--docker-host-vm2">WireGuard & Docker</a></kbd> ‚Ä¢
  <kbd><a href="#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∏-–∑–∞–ø—É—Å–∫">Quick Start</a></kbd>
</p>
</div>
</br>

---

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑ —Ç—Ä–µ—Ö —É–∑–ª–æ–≤. –ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **IaC (Infrastructure as Code)**.

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å **Bash-—Å–∫—Ä–∏–ø—Ç–∞–º–∏**, **–Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Å–µ—Ç–µ–π**, **Linux –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Security)** –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á**, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ SSH-–∫–ª—é—á–µ–π –±–µ–∑ —É—á–∞—Å—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–∞.


## üèó Architecture of virtual machines & ‚ö°Ô∏è Key features of automation

–°—Ç–µ–Ω–¥ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω (Ubuntu 22.04), –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –≤ –ø—Ä–∏–≤–∞—Ç–Ω—É—é —Å–µ—Ç—å `192.168.56.0/24`.

*–¢–∞–±–ª–∏—Ü–∞ 1. –†–æ–ª–∏ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —É–∑–ª–æ–≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã*

| –ù–æ–¥–∞ | –†–æ–ª—å | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
| :--- | :--- | :--- |
| **VM1** | **Jump Host** | –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞. Desktop-–æ–∫—Ä—É–∂–µ–Ω–∏–µ, XRDP, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä SSH-–∫–ª—é—á–µ–π. |
| **VM2** | **VPN & Docker** | –°–µ—Ä–≤–µ—Ä WireGuard —Å Web UI –∏ Docker Engine. |
| **VM3** | **Test Node** | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É–∑–µ–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª–∏—Ç–∏–∫ –¥–æ—Å—Ç—É–ø–∞ –∏ SSH. |

### üîë 1. Zero-Touch SSH Provisioning (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞)

–í —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Vagrant –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –Ω–µ –¥–æ–≤–µ—Ä—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É. –ß—Ç–æ–±—ã –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –∏—Ö –≤ –µ–¥–∏–Ω—ã–π –∫–æ–Ω—Ç—É—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å—Ü–µ–Ω–∞—Ä–∏–π, –≥–¥–µ **VM1 –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ —É–∑–ª–∞ (Control Node)**.

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≤–∏–∂–∏–Ω–∏–Ω–≥–∞:**

1. **Hardening Pre-check:** –ù–∞ —ç—Ç–∞–ø–µ —Å—Ç–∞—Ä—Ç–∞ –Ω–∞ –≤—Å–µ—Ö –º–∞—à–∏–Ω–∞—Ö –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Å–º. **–¢–∞–±–ª–∏—Ü—É 2**), –Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è `PasswordAuthentication` –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
2. **Key Generation:** VM1 (Jump Host) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–∞—Ä—É –∫–ª—é—á–µ–π `Ed25519`.
3. **Host Discovery:** VM1 —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —Å–µ—Ç—å, —Å–æ–±–∏—Ä–∞–µ—Ç –æ—Ç–ø–µ—á–∞—Ç–∫–∏ (fingerprints) —Å–æ—Å–µ–¥–µ–π —Å –ø–æ–º–æ—â—å—é `ssh-keyscan` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏—Ö –≤ `known_hosts`, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ –¥–æ–≤–µ—Ä–∏–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏.
4. **Trust Injection:** –ò—Å–ø–æ–ª—å–∑—É—è —É—Ç–∏–ª–∏—Ç—É `sshpass` –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏, VM1 –≤–Ω–µ–¥—Ä—è–µ—Ç —Å–≤–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ `authorized_keys` –Ω–∞ VM2 –∏ VM3.
5. **Security Lockdown:** –°—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∫–ª—é—á—É, VM1 —É–¥–∞–ª–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö —É–∑–ª–∞—Ö –¥–ª—è **–ø–æ–ª–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –ø–∞—Ä–æ–ª—é**. –í –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ VM1 –æ—Ç–∫–ª—é—á–∞–µ—Ç –≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é –∏ —É —Å–µ–±—è.

**–ò—Ç–æ–≥:** –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≥–æ—Ç–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, –≥–¥–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å VM1 –ø–æ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º –∫–ª—é—á–∞–º, –∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å `PasswordAuthentication` –æ—Ç–∫–ª—é—á–µ–Ω–∞.

*–¢–∞–±–ª–∏—Ü–∞ 2. SSH Security Hardening (–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `/etc/ssh/sshd_config`)*

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| --- | --- | --- |
| **Protocol** | `2` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–æ—Ç—Å–µ–∫–∞–µ–º SSH-1). |
| **PermitRootLogin** | `no` | –ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–µ—Ç –≤—Ö–æ–¥–∞ –ø–æ–¥ root-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. |
| **PasswordAuthentication** | `no` | –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø–æ SSH-–∫–ª—é—á–∞–º (–æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–æ–≤–∏–∂–∏–Ω–∏–Ω–≥–∞). |
| **MaxAuthTries** | `2` | –ñ–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞. |
| **LoginGraceTime** | `10s` | –û–±—Ä—ã–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª—Å—è –∑–∞ 10 —Å–µ–∫—É–Ω–¥. |
| **MaxSessions** | `2` | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö SSH-—Å–µ—Å—Å–∏–π. |
| **PermitEmptyPasswords** | `no` | –ó–∞–ø—Ä–µ—Ç –ø—É—Å—Ç—ã—Ö –ø–∞—Ä–æ–ª–µ–π. |
| **HostbasedAuthentication** | `no` | –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –º–µ–Ω–µ–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ —Ö–æ—Å—Ç–æ–≤. |


```mermaid
graph TD
    subgraph Isolated Private Segment 192.168.56.0/24
        VM1[VM1: Jump Host<br/>192.168.56.100]
        VM2[VM2: WireGuard & Docker<br/>192.168.56.101]
        VM3[VM3: Test Node<br/>192.168.56.102]
    end

    VM1 -.->|1. sshpass: Inject Key| VM2
    VM1 -.->|1. sshpass: Inject Key| VM3
    VM1 ==>|2. Passwordless SSH| VM2
    VM1 ==>|2. Passwordless SSH| VM3

```

*–†–∏—Å. 1. –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è SSH-–∫–ª—é—á–µ–π –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ —Å–µ—Ç–∏.*

### üñ• 2. Jump Host —Å GUI (VM1)

* –†–∞–∑–≤–µ—Ä–Ω—É—Ç `ubuntu-desktop-minimal`.
* –ù–∞—Å—Ç—Ä–æ–µ–Ω **XRDP** –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ —Å —Ö–æ—Å—Ç–æ–≤–æ–π –º–∞—à–∏–Ω—ã.
* –î–æ–±–∞–≤–ª–µ–Ω `xrdp` –≤ –≥—Ä—É–ø–ø—É `ssl-cert` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.
* –õ–æ–∫–∞–ª—å–Ω—ã–π DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ `/etc/hosts` –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –Ω–æ–¥–∞–º –ø–æ –∏–º–µ–Ω–∞–º (`ssh ubuntu@vm2`,`ssh ubuntu@vm3`).

### üê≥ 3. WireGuard VPN & Docker Host (VM2)

* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ **Docker Engine** —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º GPG-–∫–ª—é—á–µ–π.
* –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ WireGuard —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–ª–∏–∑–∞ [WireGuard UI](https://github.com/ngoduykhanh/wireguard-ui) —á–µ—Ä–µ–∑ GitHub API.
* **Watchdog-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å–∏—Å—Ç–µ–º–Ω—ã–µ —é–Ω–∏—Ç—ã `systemd.path` –∏ `systemd.service`. –ü—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ VPN —á–µ—Ä–µ–∑ –≤–µ–±-–∞–¥–º–∏–Ω–∫—É, —Ç—Ä–∏–≥–≥–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç—É–Ω–Ω–µ–ª—å `wg-quick@wg0`.

### üë§ 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (VM3)

* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `adam` —Å –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π –∏ –æ–±–æ–ª–æ—á–∫–æ–π bash.
* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `passwordless sudo` —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é drop-in —Ñ–∞–π–ª–æ–≤ –≤ `/etc/sudoers.d/` —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (440).


### üîå 5. Connectivity & Access Points (–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞)

* **Jump Host (VM1):** –î–æ—Å—Ç—É–ø–µ–Ω –ø–æ RDP —á–µ—Ä–µ–∑ `[Host_IP]:13389`. –ë–∏–Ω–¥–∏–Ω–≥ –Ω–∞ `0.0.0.0` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –≤ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ª–∞–±—ã —Å –ª—é–±–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏.
* **VPN Tunnel (VM2):** –ü–æ—Ä—Ç `51820/UDP` –æ—Ç–∫—Ä—ã—Ç –Ω–∞ `0.0.0.0` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö WireGuard-–∫–ª–∏–µ–Ω—Ç–æ–≤.
* **WireGuard Web UI:** `http://127.0.0.1:16000`.
* *Security Note:* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –∑–∞–±–∏–Ω–∂–µ–Ω–∞ –Ω–∞ `127.0.0.1` —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—ã. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π HTTP-—Ç—Ä–∞—Ñ–∏–∫ –∞–¥–º–∏–Ω–∫–∏ –Ω–µ –ø–æ–∫–∏–¥–∞–µ—Ç –≤–∞—à –∫–æ–º–ø—å—é—Ç–µ—Ä –∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ.


```mermaid
graph TD
    subgraph Host Machine Interfaces
        Localhost[127.0.0.1<br/>Local Only]
        All_Interfaces[0.0.0.0<br/>All Interfaces]
    end

    %% –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏ –∞–¥—Ä–µ—Å–∞
    Localhost -->|TCP 16000<br/>HTTP| VM2_WG[VM2: WG Web UI<br/>Port 6000]
    All_Interfaces -->|TCP 13389<br/>RDP| VM1_RDP[VM1: RDP Desktop<br/>Port 3389]
    All_Interfaces -->|UDP 51820<br/>VPN| VM2_VPN[VM2: WG Tunnel<br/>Port 51820]

    subgraph Segment 192.168.56.0/24
        VM1_RDP
        VM2_WG
        VM2_VPN
        VM3[VM3: Test Node]
    end

```

*–†–∏—Å. 2. –°—Ö–µ–º–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤ (Port Forwarding) –º–µ–∂–¥—É —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º–æ–π –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç—É—Ä–æ–º.*


---

## üöÄ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ó–∞–ø—É—Å–∫

> **–í–∞–∂–Ω–æ:** –î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∂–µ—Å—Ç–∫–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –ø—Ä–æ–≤–∞–π–¥–µ—Ä **VirtualBox**. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (Hyper-V, VMware, Libvirt) –ø–æ—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –ª–æ–≥–∏–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (`private_network`) –∏ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –ø—Ä–æ–±—Ä–æ—Å–∞ –ø–æ—Ä—Ç–æ–≤.

* **–ü—Ä–æ–≤–∞–π–¥–µ—Ä:** VirtualBox (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –Ω–∞ 7.2.4).
* **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Vagrant (2.4.9).
* **–û–°:** –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π [ubuntu/jammy64](https://portal.cloud.hashicorp.com/vagrant/discover/ubuntu/jammy64) –æ—Ç Canonical.

> ü™ü **–í–Ω–∏–º–∞–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Windows (Hyper-V Conflict):**
> –ï—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –≤–∫–ª—é—á–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Hyper-V, —Å–≤—è–∑–∫–∞ Vagrant + VirtualBox –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ (—á–∞—â–µ –≤—Å–µ–≥–æ —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–∞–π–º–∞—É—Ç–∞–º –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ Vagrant –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –º–∞—à–∏–Ω–µ –ø–æ SSH). 
> 
> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞ –º–æ–∂–Ω–æ –≤ `cmd` –∏–ª–∏ `PowerShell`:
> ```cmd
> systeminfo | findstr /i hyper
> ```

**–ó–∞–ø—É—Å–∫:**

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
```bash
git clone https://github.com/mascotmascot1/vagrant-wireguard-iac-lab.git
cd vagrant-wireguard-iac-lab

```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ç—å:** –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `$public_ip` –≤ `Vagrantfile`, —á—Ç–æ–±—ã –æ–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `192.168.1.100`).
3. **–ü–æ–¥–Ω–∏–º–∏—Ç–µ —Å—Ç–µ–Ω–¥:**
```bash
vagrant up

```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (Verification)

–ß—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ—Ç—Ä–∞–±–æ—Ç–∞–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VM1:**
```bash
vagrant ssh vm1

```

2. **–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `ubuntu**` (–∏–º–µ–Ω–Ω–æ –¥–ª—è –Ω–µ–≥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–ª—é—á–∏):
```bash
sudo su - ubuntu

```


3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–µ—Å–ø–∞—Ä–æ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–æ—Å–µ–¥–Ω–∏–º —É–∑–ª–∞–º:**
```bash
ssh vm2  # –í—Ö–æ–¥ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è

```


4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã docker –∏ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ wireguard –Ω–∞ VM2:**
```bash
sudo wg show
sudo systemctl status wg-quick@wg0
sudo systemctl status docker
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è **–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ü–µ–ª–µ–π**.

* –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É HTTP.
* –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏.
**–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Å–µ—Ç—è—Ö –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ TLS –∏ —Å–º–µ–Ω—ã —Å–µ–∫—Ä–µ—Ç–æ–≤!**

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ **MIT**.  
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º. –≤ —Ñ–∞–π–ª–µ [`LICENSE`](./LICENSE).
